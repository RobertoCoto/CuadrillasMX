<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper	namespace="com.fyg.cuadrillas.dao.ActividadTx">

<insert id="registraActividad" parameterType="Actividad">
INSERT INTO actividad_diaria(id_cuadrilla,tramo_inicial_planificado,tramo_final_planificado,alcance_planificado,
tramo_inicial_real,tramo_final_real,alcance_real,actividad,prioridad,estado,tiempo_destinado,numero_personas,numero_unidades,
porcentaje_completado,listo_vencido,observaciones_actividad,fecha_alta,usuario_alta,estatus)
VALUES(#{idCuadrilla},#{tramoInicialPlanificado},#{tramoFinalPlanificado},#{alcancePlanificado},#{tramoInicialReal},#{tramoFinalReal},#{alcanceReal},
#{actividad},#{prioridad},#{estado},#{tiempoDestinado},#{numeroPersonas},#{numeroUnidades},#{porcentajeCompletado},#{listoVencido},#{observacionesActividades},
now(),#{usuarioAlta},'A')
</insert>

<update id="autorizaActividad" parameterType="Actividad">
UPDATE actividad_diaria SET
autorizacion = 'S',
fecha_autorizacion = now()
usuario_autorizacion = # {usuarioAutorizacion},
fecha_ult_mod = now(),
usuario_ult_mod = #{usuarioUltMod}
WHERE id_Actividad = #{idActividad}
AND id_cuadrilla = {idCuadrilla}
AND estatus = 'A'
</update>

<update id="bajaActividad" parameterType="Actividad">
UPDATE actividad_diaria SET
estatus = 'I',
fecha_baja = now(),
fecha_ult_mod= now()
usuario_baja = #{usuarioBaja},
usuario_ult_mod =#{usuarioUltMod}
WHERE id_Actividad = #{idActividad}
AND id_cuadrilla = {idCuadrilla}
AND estatus = 'A'
</update>
</mapper>